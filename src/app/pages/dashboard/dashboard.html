<!-- Navegação Principal -->
<header class="main-header">
  <div class="header-container">
    <div class="logo">DinMonex</div>
    <nav>
      <!-- TODO: Adicionar botão de logout -->
      <button class="logout-btn">Sair</button>
    </nav>
  </div>
</header>

<!-- Conteúdo Principal -->
<main class="dashboard-container">
  <div class="dashboard-header">
    <h1>Contas de Consumo</h1>
    <!-- O botão "Adicionar Conta" agora chama o método para abrir o modal -->
    <button class="add-btn" (click)="openAddModal()">+ Adicionar Conta</button>
  </div>

  <!-- Estados de Carregamento, Erro e Lista Vazia -->
  <div *ngIf="isLoading" class="loading-indicator">
    <p>A carregar transações...</p>
  </div>
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
  </div>
  <div *ngIf="!isLoading && !error && transactions.length === 0" class="no-transactions">
    <p>Nenhuma conta de consumo encontrada para este mês.</p>
  </div>

  <!-- Lista de Transações -->
  <div *ngIf="!isLoading && !error && transactions.length > 0" class="transactions-list">
    <div *ngFor="let transaction of transactions" class="transaction-item">
      <div class="transaction-details">
        <span class="transaction-description">{{ transaction.description }}</span>
        <span class="transaction-date">{{ transaction.dueDate | date: 'dd/MM/yyyy' }}</span>
      </div>
      <div class="transaction-value">
        <span>{{ transaction.value | currency: 'BRL' }}</span>
      </div>
      <div class="transaction-actions">
        <!-- O botão "Editar" agora chama o método para abrir o modal em modo de edição -->
        <button class="action-btn edit-btn" (click)="openEditModal(transaction.id)">Editar</button>
        <!-- O botão "Apagar" agora chama o método para apagar a transação -->
        <button class="action-btn delete-btn" (click)="deleteTransaction(transaction.id)">Apagar</button>
      </div>
    </div>
  </div>
</main>

<!-- A INTEGRAÇÃO DO MODAL ACONTECE AQUI -->
<!-- O componente do formulário só é mostrado se 'isModalVisible' for verdadeiro. -->
<!-- Ele recebe o ID da transação e emite eventos quando é fechado ou salvo. -->
<app-transaction-form 
  *ngIf="isModalVisible"
  [transactionId]="selectedTransactionId"
  (closeModal)="onCloseModal()"
  (formSaved)="onFormSaved()">
</app-transaction-form>

